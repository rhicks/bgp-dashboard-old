{% extends "layout.html" %}
{% block content %}
<body class="nav-sm">
  <div class="container body">
    <div class="main_container">
      <!-- top navigation -->
      <div class="top_nav">
        <div class="nav_menu">
          <a href="/" class="site_title"><i class="fa fa-arrows"></i>BGP Dashboard</a>
        </div>
      </div>
      <!-- /top navigation -->
      <div class="right_col" role="main">

          <!-- top tiles -->
          <div class="row tile_count">
              <div class="animated flipInY col-md-2 col-sm-4 col-xs-4 tile_stats_count">
                  <div class="left"></div>
                  <div class="right">
                      <span class="count_top">Autonomous Systems</span>
                      <div class="count">{{ '{0:,}'.format(autonomoussystems.count()) }}</div>
                      <span class="count_bottom"><i class="green"><i class="fa fa-sort-asc"></i>4 </i> Since last update</span>
                  </div>
              </div>
              <div class="animated flipInY col-md-2 col-sm-4 col-xs-4 tile_stats_count">
                  <div class="left"></div>
                  <div class="right">
                      <span class="count_top">IPv4 Prefixes</span>
                      <div class="count">{{ '{0:,}'.format(ipv4_prefixes.count()) }} </div>
                      <span class="count_bottom"><i class="green"><i class="fa fa-sort-asc"></i>3 </i> Since last update</span>
                  </div>
              </div>
              <div class="animated flipInY col-md-2 col-sm-4 col-xs-4 tile_stats_count">
                  <div class="left"></div>
                  <div class="right">
                    <span class="count_top">IPv6 Prefixes</span>
                    <div class="count">{{ '{0:,}'.format(ipv6_prefixes.count()) }} </div>
                      <span class="count_bottom"><i class="green"><i class="fa fa-sort-asc"></i>34 </i> Since last update</span>
                  </div>
              </div>
              <div class="animated flipInY col-md-2 col-sm-4 col-xs-4 tile_stats_count">
                  <div class="left"></div>
                  <div class="right">
                    <span class="count_top">BGP Peers</span>
                    <div class="count">{{ '{0:,}'.format(peers.count()) }} </div>
                      <span class="count_bottom"><i class="red"><i class="fa fa-sort-desc"></i>12 </i> Since last update</span>
                  </div>
              </div>
              <div class="animated flipInY col-md-2 col-sm-4 col-xs-4 tile_stats_count">
                  <div class="left"></div>
                  <div class="right">
                    <span class="count_top">Peering Sessions</span>
                    <div class="count">{{ '{0:,}'.format(nexthop_ips.count()) }} </div>
                      <span class="count_bottom"><i class="green"><i class="fa fa-sort-asc"></i>34 </i> Since last update</span>
                  </div>
              </div>
              <div class="animated flipInY col-md-2 col-sm-4 col-xs-4 tile_stats_count">
                  <div class="left"></div>
                  <div class="right">
                      <span class="count_top">Last Update</span>
                      <div class="count">Today</div>
                  </div>
              </div>
          </div>
          <!-- /top tiles -->
      <!-- page content -->
      <table id="example" class="table table-striped responsive-utilities jambo_table">
        <thead>
            <tr class="headings">
                <th>ASN </th>
                <th>Name </th>
                <th>Description </th>
                <th>Orginated Routes </th>
                <th>Transit Routes </th>
                <th>Peering Sessions </th>
                <th>Selected Routes </th>
                <th>Updated </th>
            </tr>
        </thead>
        {% for asn in peers %}
          {% set dnsname = asn.asn_name_query() %}
        <tr>
          <td><a href="http://bgp.he.net/AS{{asn.asn}}">{{asn.asn}}</a></td>
          {% if dnsname.split(' -', 1)[1] %}
            <td>{{dnsname.split(' -', 1)[1]}}</td>
            <td>{{dnsname.split(' -', 1)[0]}}</td>
          {% else %}
            <td>{{dnsname.split(' ', 1)[1]}}</td>
            <td>{{dnsname.split(' ', 1)[0]}}</td>
          {% endif %}
          <td>{{asn.origin_prefixes.count()}}</td>
          <td>{{asn.best_routes.count()}}</td>
          <td>{{asn.peering_sessions(asn)|length}}</td>
          <td class="project_progress">
            <div class="progress progress_sm">
                {% set precent = (asn.best_routes.count()/autonomoussystems.count()) * 10 %}
                <div class="progress-bar bg-green" role="progressbar" data-transitiongoal={{precent}} aria-valuenow={{precent}} style="width: {{precent}}%;"></div>
            </div>
            <small>{{ '{:.2f}'.format(precent) }}% Routes</small>
          </td>
          <td>{{asn.modified_timestamp.strftime("%Y-%m-%d %H:%M:%S %Z")}}</td>
        </tr>
        {% endfor %}
      </table>
      <!-- /page content -->
    </div>
  </div>
</body>
{% endblock %}
